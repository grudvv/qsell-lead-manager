<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QSell Lead Manager - System Zarządzania Leadami</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="app">
        <!-- Login Modal -->
        <div id="loginModal" class="modal login-modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2><i class="fas fa-lock"></i> Logowanie QSell Lead Manager</h2>
                    <span class="close" onclick="closeLoginModal()">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="loginForm" onsubmit="handleLogin(event)">
                        <div class="form-group">
                            <label for="username">Nazwa użytkownika:</label>
                            <input type="text" id="username" name="username" required>
                        </div>
                        <div class="form-group">
                            <label for="password">Hasło:</label>
                            <input type="password" id="password" name="password" required>
                        </div>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-sign-in-alt"></i> Zaloguj się
                        </button>
                    </form>
                    <div id="loginError" class="error-message" style="display: none;"></div>
                </div>
            </div>
        </div>

        <!-- Main Application (hidden until login) -->
        <div id="mainApp" style="display: none;">
            <!-- Header -->
            <header class="header">
                <div class="container">
                    <div class="logo-section">
                        <div class="logo">
                            <div class="logo-icon">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <div class="logo-text">
                                <h1>QSell Lead Manager</h1>
                                <span>System Zarządzania Leadami</span>
                            </div>
                        </div>
                    </div>
                    <div class="header-actions">
                        <button class="btn btn-secondary" onclick="toggleTheme()">
                            <i class="fas fa-moon"></i> Dark Mode
                        </button>
                        <button class="btn btn-primary" onclick="logout()">
                            <i class="fas fa-sign-out-alt"></i> Wyloguj
                        </button>
                    </div>
                </div>
            </header>

            <!-- Quick Stats -->
            <section class="quick-stats">
                <div class="container">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon leads">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="totalLeads">0</h3>
                                <p>Wszystkie Leady</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon new">
                                <i class="fas fa-plus-circle"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="newLeads">0</h3>
                                <p>Nowe Leady</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon quotes">
                                <i class="fas fa-file-invoice-dollar"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="totalQuotes">0</h3>
                                <p>Wszystkie Wyceny</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon meta">
                                <i class="fab fa-facebook"></i>
                            </div>
                            <div class="stat-content">
                                <h3 id="metaLeads">0</h3>
                                <p>Leady z Meta Ads</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Main Content -->
            <section class="main-content">
                <div class="container">
                    <!-- Tabs -->
                    <div class="tabs">
                        <button class="tab-btn active" onclick="showTab('leads')">
                            <i class="fas fa-users"></i> Leady
                        </button>
                        <button class="tab-btn" onclick="showTab('quotes')">
                            <i class="fas fa-file-invoice-dollar"></i> Wyceny
                        </button>
                        <button class="tab-btn" onclick="showTab('calculator')">
                            <i class="fas fa-calculator"></i> Kalkulator Wyceny
                        </button>
                        <button class="tab-btn" onclick="showTab('meta')">
                            <i class="fab fa-facebook"></i> Meta Ads
                        </button>
                    </div>

                    <!-- Leads Tab -->
                    <div id="leadsTab" class="tab-content active">
                        <div class="tab-header">
                            <h2><i class="fas fa-users"></i> Zarządzanie Leadami</h2>
                            <button class="btn btn-primary" onclick="showAddLeadModal()">
                                <i class="fas fa-plus"></i> Dodaj Lead
                            </button>
                        </div>
                        <div class="leads-list" id="leadsList">
                            <!-- Leady będą dodawane dynamicznie -->
                        </div>
                    </div>

                    <!-- Quotes Tab -->
                    <div id="quotesTab" class="tab-content">
                        <div class="tab-header">
                            <h2><i class="fas fa-file-invoice-dollar"></i> System Wycen</h2>
                            <button class="btn btn-primary" onclick="showAddQuoteModal()">
                                <i class="fas fa-plus"></i> Nowa Wycena
                            </button>
                        </div>
                        <div class="quotes-list" id="quotesList">
                            <!-- Wyceny będą dodawane dynamicznie -->
                        </div>
                    </div>

                    <!-- Calculator Tab -->
                    <div id="calculatorTab" class="tab-content">
                        <div class="tab-header">
                            <h2><i class="fas fa-calculator"></i> Kalkulator Wyceny QSell</h2>
                        </div>
                        <div class="calculator-content">
                            <div class="pricing-grid">
                                <div class="pricing-card">
                                    <h3>Amazon</h3>
                                    <div class="pricing-item">
                                        <span>Wdrożenie:</span>
                                        <span>4000-5000 PLN</span>
                                    </div>
                                    <div class="pricing-item">
                                        <span>Obsługa ADS:</span>
                                        <span>1890 PLN/mies.</span>
                                    </div>
                                </div>
                                <div class="pricing-card">
                                    <h3>eBay</h3>
                                    <div class="pricing-item">
                                        <span>Wdrożenie:</span>
                                        <span>2500-3500 PLN</span>
                                    </div>
                                    <div class="pricing-item">
                                        <span>Obsługa ADS:</span>
                                        <span>1390 PLN/mies.</span>
                                    </div>
                                </div>
                                <div class="pricing-card">
                                    <h3>eMag</h3>
                                    <div class="pricing-item">
                                        <span>Wdrożenie:</span>
                                        <span>3000-10000 PLN</span>
                                    </div>
                                    <div class="pricing-item">
                                        <span>Obsługa ADS:</span>
                                        <span>790 PLN/mies.</span>
                                    </div>
                                    <div class="pricing-item">
                                        <span>Kompleks:</span>
                                        <span>1500 PLN/mies.</span>
                                    </div>
                                </div>
                                <div class="pricing-card">
                                    <h3>Kaufland</h3>
                                    <div class="pricing-item">
                                        <span>Wdrożenie:</span>
                                        <span>2500-4500 PLN</span>
                                    </div>
                                    <div class="pricing-item">
                                        <span>Obsługa ADS:</span>
                                        <span>1390 PLN/mies.</span>
                                    </div>
                                </div>
                                <div class="pricing-card">
                                    <h3>Empik</h3>
                                    <div class="pricing-item">
                                        <span>Wdrożenie:</span>
                                        <span>3000-10000 PLN</span>
                                    </div>
                                    <div class="pricing-item">
                                        <span>Obsługa ADS:</span>
                                        <span>790 PLN/mies.</span>
                                    </div>
                                    <div class="pricing-item">
                                        <span>Kompleks:</span>
                                        <span>1190 PLN/mies.</span>
                                    </div>
                                </div>
                                <div class="pricing-card">
                                    <h3>ERLI</h3>
                                    <div class="pricing-item">
                                        <span>Wdrożenie:</span>
                                        <span>3000-10000 PLN</span>
                                    </div>
                                    <div class="pricing-item">
                                        <span>Standard:</span>
                                        <span>790 PLN/mies.</span>
                                    </div>
                                    <div class="pricing-item">
                                        <span>Kompleks:</span>
                                        <span>1190 PLN/mies.</span>
                                    </div>
                                </div>
                            </div>
                            <div class="discount-info">
                                <h3>Rabaty za Pakiety</h3>
                                <p><strong>500 PLN rabatu</strong> za pakiet z minimum 2 usługami</p>
                                <p><strong>Rabat procentowy</strong> - ustawiany ręcznie przez admina</p>
                            </div>
                        </div>
                    </div>

                    <!-- Meta Ads Tab -->
                    <div id="metaTab" class="tab-content">
                        <div class="tab-header">
                            <h2><i class="fab fa-facebook"></i> Meta Ads Integration</h2>
                        </div>
                        <div class="meta-content">
                            <div class="meta-status">
                                <h3>Status Integracji</h3>
                                <div class="status-item">
                                    <span>Webhook URL:</span>
                                    <code id="webhookUrl">https://twoja-domena.pl/api/meta-webhook.php</code>
                                </div>
                                <div class="status-item">
                                    <span>Token weryfikacji:</span>
                                    <code>qsell_webhook_2024</code>
                                </div>
                                <div class="status-item">
                                    <span>Status:</span>
                                    <span class="status-badge active">Aktywny</span>
                                </div>
                            </div>
                            <div class="meta-instructions">
                                <h3>Instrukcje Konfiguracji</h3>
                                <ol>
                                    <li>Idź na <a href="https://developers.facebook.com" target="_blank">developers.facebook.com</a></li>
                                    <li>Utwórz nową aplikację "Business" → "Lead Ads"</li>
                                    <li>W Meta Ads Manager dodaj webhook URL</li>
                                    <li>Użyj tokenu weryfikacji: <code>qsell_webhook_2024</code></li>
                                </ol>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <!-- Modal dodawania leada -->
    <div id="addLeadModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-user-plus"></i> Dodaj nowego leada</h3>
                <button class="modal-close" onclick="closeAddLeadModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="addLeadForm" onsubmit="addNewLead(event)">
                <div class="form-group">
                    <label for="leadName">Imię i nazwisko *</label>
                    <input type="text" id="leadName" name="name" required>
                </div>
                <div class="form-group">
                    <label for="leadEmail">Email *</label>
                    <input type="email" id="leadEmail" name="email" required>
                </div>
                <div class="form-group">
                    <label for="leadPhone">Telefon</label>
                    <input type="tel" id="leadPhone" name="phone">
                </div>
                <div class="form-group">
                    <label for="leadCompany">Firma</label>
                    <input type="text" id="leadCompany" name="company">
                </div>
                <div class="form-group">
                    <label for="leadSource">Źródło</label>
                    <select id="leadSource" name="source">
                        <option value="manual">Ręczne dodanie</option>
                        <option value="meta_ads">Meta Ads</option>
                        <option value="website">Strona WWW</option>
                        <option value="referral">Polecenie</option>
                        <option value="other">Inne</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="leadCampaign">Kampania</label>
                    <input type="text" id="leadCampaign" name="campaign">
                </div>
                <div class="form-group">
                    <label for="leadNotes">Notatki</label>
                    <textarea id="leadNotes" name="notes" rows="3"></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeAddLeadModal()">Anuluj</button>
                    <button type="submit" class="btn btn-primary">Dodaj leada</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal dodawania wyceny -->
    <div id="addQuoteModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-calculator"></i> Dodaj nową wycenę</h3>
                <button class="modal-close" onclick="closeAddQuoteModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="addQuoteForm" onsubmit="addNewQuote(event)">
                <div class="form-group">
                    <label for="quoteLead">Lead *</label>
                    <select id="quoteLead" name="lead_id" required>
                        <option value="">Wybierz leada</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="quoteTitle">Tytuł wyceny *</label>
                    <input type="text" id="quoteTitle" name="title" required>
                </div>
                <div class="form-group">
                    <label for="quoteDescription">Opis</label>
                    <textarea id="quoteDescription" name="description" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label for="quoteDiscount">Rabat procentowy (%)</label>
                    <input type="number" id="quoteDiscount" name="discount_percent" min="0" max="50" value="0">
                </div>
                <div class="form-group">
                    <label>Usługi w wycenie</label>
                    <div id="quoteServices">
                        <div class="service-item">
                            <select name="services[0][service_type]" required>
                                <option value="">Wybierz usługę</option>
                                <option value="implementation">Wdrożenie</option>
                                <option value="ads_monthly">Obsługa ADS</option>
                                <option value="complex_monthly">Kompleks</option>
                            </select>
                            <select name="services[0][platform]" required>
                                <option value="">Platforma</option>
                                <option value="amazon">Amazon</option>
                                <option value="ebay">eBay</option>
                                <option value="emag">eMag</option>
                                <option value="kaufland">Kaufland</option>
                                <option value="empik">Empik</option>
                                <option value="erli">ERLI</option>
                                <option value="allegro_cz_sk_hu">Allegro CZ/SK/HU</option>
                                <option value="base_com">Base.com</option>
                            </select>
                            <select name="services[0][package_type]" required>
                                <option value="">Pakiet</option>
                                <option value="basic">Podstawowy</option>
                                <option value="standard">Standard</option>
                                <option value="premium">Premium</option>
                            </select>
                            <input type="number" name="services[0][quantity]" placeholder="Ilość" min="1" value="1" required>
                        </div>
                    </div>
                    <button type="button" class="btn btn-secondary" onclick="addServiceItem()">
                        <i class="fas fa-plus"></i> Dodaj usługę
                    </button>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeAddQuoteModal()">Anuluj</button>
                    <button type="submit" class="btn btn-primary">Utwórz wycenę</button>
                </div>
            </form>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
